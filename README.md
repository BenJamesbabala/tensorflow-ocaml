The tensorflow-ocaml project provides some [OCaml](http://ocaml.org) bindings for [TensorFlow](http://tensorflow.org).

These bindings are in a very early stage of their development and are not ready for real-world usage. They are likely to change a lot in the near future. Expect some segfaults if you use them for now.

## Installation

* Install the dependencies.
`opam install ocamlbuild ctypes ctypes-foreign`
You may also have to install the python-dev package.
* Clone the repo.
`git clone https://github.com/LaurentMazare/tensorflow-ocaml.git`
* Install [TensorFlow](http://tensorflow.org).
* Copy the TensorFlow shared library to `lib/libtensorflow.so` in the cloned repo. The following command may work.
`cp ~/.local/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow.so lib/libtensorflow.so`
* Try executing the examples from the root of the cloned repo.
`make run`

## Examples

* `examples/load.ml` contains a simple example where the TensorFlow graph is loaded from a file (this graph has been generated by `examples/load.py`).
* `examples/simple.ml` and `examples/var.ml` show how to generate a TensorFlow graph from OCaml and execute it.

## Generating the TensorFlow Graph from OCaml

The TensorFlow graph operators are defined in `src/ops.ml`. This code has been automatically generated from `gen_ops/ops.pbtxt` which comes from the TensorFlow distribution.
Only the basic operators are likely to work for now.

Optimizer functions like `GradientDescentOptimizer` are not available for now. Such functions generate a graph containing the symbolic gradients for the minimized function, this is done in the Python side of TensorFlow so it's likely we will need the same thing will have to be implemented in OCaml.

## Dependencies

* [ocaml-ctypes](https://github.com/ocamllabs/ocaml-ctypes) is used for the C bindings.
* [Core](https://github.com/janestreet/core) is only necessary for the operator code generation.
* The code in the piqi directory comes from the [Piqi project](http://piqi.org). There is no need to install piqi though.
