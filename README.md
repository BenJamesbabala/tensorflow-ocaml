The tensorflow-ocaml project provides some [OCaml](http://ocaml.org) bindings for [TensorFlow](http://tensorflow.org).

These bindings are in an early stage of their development. Some operators are not supported and the API is likely to change in the future. You may also encounter some segfaults. That being said they already contain the necessary to train a convolution network using various optimizers.

## Installation

You can either clone the git repo and build things from there or use opam to build and install the lib.

```bash
opam pin add tensorflow-ocaml git://github.com/LaurentMazare/tensorflow-ocaml
```

After that you have to install the shared library for TensorFlow, you can do so by [installing TensorFlow](https://www.tensorflow.org/versions/r0.7/get_started/os_setup.html#pip-installation) then copying the `.so` file in `libtensorflow.so` (and have the corresponding directory in your LD_LIBRARY_PATH). You may have to tweak the following command depending on where TensorFlow was installed.
```bash
cp ~/.local/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow.so libtensorflow.so
```
If you've installed the cuda version of TensorFlow then you should be able to use your GPU from the OCaml bindings too.

Finally download a [very simple example](https://github.com/LaurentMazare/tensorflow-ocaml/tree/master/examples/basics/forty_two.ml) and compile it with the following command:
```bash
ocamlbuild forty_two.native -package ctypes -package ctypes.foreign -package core_kernel -package tensorflow-ocaml
```

Enjoy!

## Examples

The MNIST tutorials from TensorFlow have been converted in OCaml and can be found [here](https://github.com/LaurentMazare/tensorflow-ocaml/tree/master/examples/mnist). For these examples, you will have to unzip the [MNIST data files](http://yann.lecun.com/exdb/mnist/) in `data/`.

* `examples/load/load.ml` contains a simple example where the TensorFlow graph is loaded from a file (this graph has been generated by `examples/load.py`).
* `examples/basics` contains some curve fitting examples. You will need gnuplot to be installed via opam to run the gnuplot versions.

## Generating the TensorFlow Graph from OCaml

The TensorFlow graph operators are defined in `src/graph/ops_generated.ml`. This file has been automatically generated from `src/gen_ops/ops.pbtxt` which comes from the TensorFlow distribution.
Only the basic operators are likely to work for now.

## Dependencies

* [ocaml-ctypes](https://github.com/ocamllabs/ocaml-ctypes) is used for the C bindings.
* [Core](https://github.com/janestreet/core) is only necessary when generating the graph from OCaml, the wrapper itself does not need it.
* The code in the piqi directory comes from the [Piqi project](http://piqi.org). There is no need to install piqi though.
