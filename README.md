The tensorflow-ocaml project provides some [OCaml](http://ocaml.org) bindings for [TensorFlow](http://tensorflow.org).

These bindings are in a very early stage of their development and are not ready for real-world usage. They are likely to change a lot in the near future. Expect some segfaults if you use them for now.

## Installation

#### Install the dependencies
```bash
opam install ocamlbuild ctypes ctypes-foreign core
```
You may also have to install the python-dev package.
#### Clone the repo
```bash
git clone https://github.com/LaurentMazare/tensorflow-ocaml.git
```
#### Install [TensorFlow](http://tensorflow.org)
Copy the TensorFlow shared library to `lib/libtensorflow.so` in the cloned repo. You may have to tweak the following command depending on where TensorFlow was installed.
```bash
cp ~/.local/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow.so lib/libtensorflow.so
```
If you've installed the cuda version of TensorFlow then you should be able to use your GPU from the OCaml bindings too.

#### Try executing the examples from the root of the cloned repo
```bash
make run
```
Enjoy!

## Examples

The MNIST tutorials from TensorFlow have been converted in OCaml and can be found [here](https://github.com/LaurentMazare/tensorflow-ocaml/tree/master/examples/mnist).
* `examples/load/load.ml` contains a simple example where the TensorFlow graph is loaded from a file (this graph has been generated by `examples/load.py`).

## Generating the TensorFlow Graph from OCaml

The TensorFlow graph operators are defined in `src/graph/ops.ml`. This file has been automatically generated from `src/gen_ops/ops.pbtxt` which comes from the TensorFlow distribution.
Only the basic operators are likely to work for now.

## Dependencies

* [ocaml-ctypes](https://github.com/ocamllabs/ocaml-ctypes) is used for the C bindings.
* [Core](https://github.com/janestreet/core) is only necessary when generating the graph from OCaml, the wrapper itself does not need it.
* The code in the piqi directory comes from the [Piqi project](http://piqi.org). There is no need to install piqi though.
